{% load static %}

<article class="card mb-3 answer" id="answer-{{ a.id }}">
  <div class="card-body d-flex gap-3">
    <div class="text-center">
      <!-- Отображение аватара пользователя -->
      {% if a.author.profile.avatar %}
        <img src="{{ a.author.profile.avatar.url }}" alt="Аватар" width="40" height="40" class="rounded-circle mb-1">
      {% else %}
        <img src="{% static 'img/logo.png' %}" alt="Аватар" width="40" height="40" class="rounded-circle mb-1">
      {% endif %}

      <!-- Блок оценки ответа -->
      <div class="vote">
        {% if user.is_authenticated %}
        <button type="button" class="vote-button up like-btn" data-answer-id="{{ a.id }}" data-type="like" aria-label="Голос за">▲</button>
        {% else %}
        <button type="button" class="vote-button up" disabled aria-label="Голос за">▲</button>
        {% endif %}

        <div class="vote-count" id="score-answer-{{ a.id }}">{{ a.score }}</div>

        {% if user.is_authenticated %}
        <button type="button" class="vote-button down dislike-btn" data-answer-id="{{ a.id }}" data-type="dislike" aria-label="Голос против">▼</button>
        {% else %}
        <button type="button" class="vote-button down" disabled aria-label="Голос против">▼</button>
        {% endif %}
      </div>

      <!-- Кнопка отметки "правильный ответ" (только для автора вопроса) -->
      {% if question.author == user %}
        {% if not a.is_accepted %}
          {% if not has_accepted_answer %}
            <button type="button" class="btn btn-outline-primary btn-sm mark-correct-btn" data-answer-id="{{ a.id }}" style="min-width: 150px; max-width: 150px;">
              Отметить как правильный
            </button>
          {% endif %}
        {% else %}
          <button type="button" class="btn btn-success btn-sm unmark-correct-btn" data-answer-id="{{ a.id }}" style="min-width: 150px; max-width: 150px;">
            Правильный ответ
          </button>
        {% endif %}
      {% endif %}
    </div>

    <div class="flex-grow-1">
      <div class="d-flex align-items-center gap-2 mb-1">
        <span class="small text-muted">от {{ a.author }} • {{ a.created }}</span>

        {% if a.is_accepted %}
        {% endif %}
      </div>
      <div>{{ a.text }}</div>
    </div>
  </div>
</article>